"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[88425],{34422:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var r=n(74848),o=n(28453);const s={title:"Operators"},a=void 0,i={id:"middleware/prometheus/operators",title:"Operators",description:"Binary operators",source:"@site/docs/00600-middleware/prometheus/0310-operators.md",sourceDirName:"00600-middleware/prometheus",slug:"/middleware/prometheus/operators",permalink:"/dddtdd-docs/middleware/prometheus/operators",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1720187019e3,sidebarPosition:310,frontMatter:{title:"Operators"},sidebar:"docSidebar",previous:{title:"Querying Basics",permalink:"/dddtdd-docs/middleware/prometheus/querying-basics"},next:{title:"Functions",permalink:"/dddtdd-docs/middleware/prometheus/functions"}},l={},c=[{value:"Binary operators",id:"binary-operators",level:2},{value:"Vector matching",id:"vector-matching",level:2},{value:"One-to-one vector matches",id:"one-to-one-vector-matches",level:3},{value:"Many-to-one and one-to-many vector matches",id:"many-to-one-and-one-to-many-vector-matches",level:3},{value:"Aggregation operators",id:"aggregation-operators",level:2}];function d(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"binary-operators",children:"Binary operators"}),"\n",(0,r.jsx)(t.h2,{id:"vector-matching",children:"Vector matching"}),"\n",(0,r.jsx)(t.h3,{id:"one-to-one-vector-matches",children:"One-to-one vector matches"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-r",children:'method_code:http_errors:rate5m{code="500"} / ignoring(code) method:http_requests:rate5m\n'})}),"\n",(0,r.jsx)(t.h3,{id:"many-to-one-and-one-to-many-vector-matches",children:"Many-to-one and one-to-many vector matches"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-r",children:"method_code:http_errors:rate5m / ignoring(code) group_left method:http_requests:rate5m\n"})}),"\n",(0,r.jsx)(t.h2,{id:"aggregation-operators",children:"Aggregation operators"}),"\n",(0,r.jsx)(t.p,{children:"Prometheus supports the following built-in aggregation operators that can be used to aggregate the elements of a single instant vector, resulting in a new vector of fewer elements with aggregated values:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"sum (calculate sum over dimensions)"}),"\n",(0,r.jsx)(t.li,{children:"min (select minimum over dimensions)"}),"\n",(0,r.jsx)(t.li,{children:"max (select maximum over dimensions)"}),"\n",(0,r.jsx)(t.li,{children:"avg (calculate the average over dimensions)"}),"\n",(0,r.jsx)(t.li,{children:"group (all values in the resulting vector are 1)"}),"\n",(0,r.jsx)(t.li,{children:"stddev (calculate population standard deviation over dimensions)"}),"\n",(0,r.jsx)(t.li,{children:"stdvar (calculate population standard variance over dimensions)"}),"\n",(0,r.jsx)(t.li,{children:"count (count number of elements in the vector)"}),"\n",(0,r.jsx)(t.li,{children:"count_values (count number of elements with the same value)"}),"\n",(0,r.jsx)(t.li,{children:"bottomk (smallest k elements by sample value)"}),"\n",(0,r.jsx)(t.li,{children:"topk (largest k elements by sample value)"}),"\n",(0,r.jsx)(t.li,{children:"quantile (calculate \u03c6-quantile (0 \u2264 \u03c6 \u2264 1) over dimensions)"}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["These operators can either be used to aggregate over all label dimensions or preserve distinct dimensions by including a ",(0,r.jsx)(t.code,{children:"without"})," or ",(0,r.jsx)(t.code,{children:"by"})," clause"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-r",children:"<aggr-op> [without|by (<label list>)] ([parameter,] <vector expression>)\n\n<aggr-op>([parameter,] <vector expression>) [without|by (<label list>)]\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-r",children:'sum without (instance) (http_requests_total)\n\nsum by (application, group) (http_requests_total)\n\ncount_values("version", build_version)\n\ntopk(5, http_requests_total)\n'})})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>i});var r=n(96540);const o={},s=r.createContext(o);function a(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);