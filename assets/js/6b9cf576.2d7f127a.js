"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[31963],{76333:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>t,metadata:()=>s,toc:()=>o});var a=n(74848),l=n(28453);const t={},i="Validators",s={id:"programming-languages/python/libs/pydantic/validators",title:"Validators",description:"Field validators",source:"@site/docs/00400-programming-languages/python/libs/pydantic/060-validators.md",sourceDirName:"00400-programming-languages/python/libs/pydantic",slug:"/programming-languages/python/libs/pydantic/validators",permalink:"/dddtdd-docs/programming-languages/python/libs/pydantic/validators",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1734870983e3,sidebarPosition:60,frontMatter:{},sidebar:"docSidebar",previous:{title:"Serialization",permalink:"/dddtdd-docs/programming-languages/python/libs/pydantic/serialization"},next:{title:"pydantic_core.core_schema",permalink:"/dddtdd-docs/programming-languages/python/libs/pydantic/pydantic_core_schema"}},d={},o=[{value:"Field validators",id:"field-validators",level:2},{value:"After validators",id:"after-validators",level:3},{value:"Before validators",id:"before-validators",level:3},{value:"Plain validators",id:"plain-validators",level:3},{value:"Wrap validators",id:"wrap-validators",level:3},{value:"Model validators",id:"model-validators",level:2},{value:"After validators",id:"after-validators-1",level:3},{value:"Validation info",id:"validation-info",level:2}];function c(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h1,{id:"validators",children:"Validators"}),"\n",(0,a.jsx)(r.h2,{id:"field-validators",children:"Field validators"}),"\n",(0,a.jsx)(r.h3,{id:"after-validators",children:"After validators"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"def is_even(value: int) -> int:\r\n    if value % 2 == 1:\r\n        raise ValueError(f'{value} is not an even number')\r\n    return value  \r\n\r\n\r\nclass Model(BaseModel):\r\n    number: Annotated[int, AfterValidator(is_even)]\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"class Model(BaseModel):\r\n    number: int\r\n\r\n    @field_validator('number', mode='after')  \r\n    @classmethod\r\n    def is_even(cls, value: int) -> int:\r\n        if value % 2 == 1:\r\n            raise ValueError(f'{value} is not an even number')\r\n        return value  \n"})}),"\n",(0,a.jsx)(r.h3,{id:"before-validators",children:"Before validators"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"def ensure_list(value: Any) -> Any:  \r\n    if not isinstance(value, list):  \r\n        return [value]\r\n    else:\r\n        return value\r\n\r\n\r\nclass Model(BaseModel):\r\n    numbers: Annotated[List[int], BeforeValidator(ensure_list)]\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"class Model(BaseModel):\r\n    numbers: List[int]\r\n\r\n    @field_validator('numbers', mode='before')\r\n    @classmethod\r\n    def ensure_list(cls, value: Any) -> Any:  \r\n        if not isinstance(value, list):  \r\n            return [value]\r\n        else:\r\n            return value\n"})}),"\n",(0,a.jsx)(r.h3,{id:"plain-validators",children:"Plain validators"}),"\n",(0,a.jsxs)(r.p,{children:["act similarly to before validators but they ",(0,a.jsx)(r.strong,{children:"terminate validation immediately"})," after returning, so no further validators are called and Pydantic does not do any of its internal validation against the field type"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"def val_number(value: Any) -> Any:\r\n    if isinstance(value, int):\r\n        return value * 2\r\n    else:\r\n        return value\r\n\r\n\r\nclass Model(BaseModel):\r\n    number: Annotated[int, PlainValidator(val_number)]\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"class Model(BaseModel):\r\n    number: int\r\n\r\n    @field_validator('number', mode='plain')\r\n    @classmethod\r\n    def val_number(cls, value: Any) -> Any:\r\n        if isinstance(value, int):\r\n            return value * 2\r\n        else:\r\n            return value\n"})}),"\n",(0,a.jsx)(r.h3,{id:"wrap-validators",children:"Wrap validators"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"from pydantic import BaseModel, Field, ValidationError, ValidatorFunctionWrapHandler, WrapValidator\r\n\r\n\r\ndef truncate(value: Any, handler: ValidatorFunctionWrapHandler) -> str:\r\n    try:\r\n        return handler(value)\r\n    except ValidationError as err:\r\n        if err.errors()[0]['type'] == 'string_too_long':\r\n            return handler(value[:5])\r\n        else:\r\n            raise\r\n\r\n\r\nclass Model(BaseModel):\r\n    my_string: Annotated[str, Field(max_length=5), WrapValidator(truncate)]\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"from pydantic import BaseModel, Field, ValidationError, ValidatorFunctionWrapHandler, field_validator\r\n\r\n\r\nclass Model(BaseModel):\r\n    my_string: Annotated[str, Field(max_length=5)]\r\n\r\n    @field_validator('my_string', mode='wrap')\r\n    @classmethod\r\n    def truncate(cls, value: Any, handler: ValidatorFunctionWrapHandler) -> str:\r\n        try:\r\n            return handler(value)\r\n        except ValidationError as err:\r\n            if err.errors()[0]['type'] == 'string_too_long':\r\n                return handler(value[:5])\r\n            else:\r\n                raise\n"})}),"\n",(0,a.jsx)(r.h2,{id:"model-validators",children:"Model validators"}),"\n",(0,a.jsx)(r.h3,{id:"after-validators-1",children:"After validators"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-py",children:"class UserModel(BaseModel):\r\n    username: str\r\n    password: str\r\n    password_repeat: str\r\n\r\n    @model_validator(mode='after')\r\n    def check_passwords_match(self) -> Self:\r\n        if self.password != self.password_repeat:\r\n            raise ValueError('Passwords do not match')\r\n        return self\n"})}),"\n",(0,a.jsx)(r.h2,{id:"validation-info",children:"Validation info"}),"\n",(0,a.jsxs)(r.p,{children:["Both the field and model validators callables (in all modes) can optionally take an extra ",(0,a.jsx)(r.code,{children:"ValidationInfo"})," argument, providing useful extra information, such as:"]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"already validated data"}),"\n",(0,a.jsx)(r.li,{children:"user defined context"}),"\n",(0,a.jsxs)(r.li,{children:["the current validation mode: either ",(0,a.jsx)(r.code,{children:"'python'"})," or ",(0,a.jsx)(r.code,{children:"'json'"})," (see the mode property)"]}),"\n",(0,a.jsxs)(r.li,{children:["the current field name (see the ",(0,a.jsx)(r.code,{children:"field_name"})," property)."]}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>s});var a=n(96540);const l={},t=a.createContext(l);function i(e){const r=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),a.createElement(t.Provider,{value:r},e.children)}}}]);