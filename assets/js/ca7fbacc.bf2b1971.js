"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[65541],{79868:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>a});var t=r(74848),d=r(28453);const i={},o=void 0,s={id:"middleware/mongo/getting-started",title:"getting-started",description:"database",source:"@site/docs/00600-middleware/mongo/010-getting-started.md",sourceDirName:"00600-middleware/mongo",slug:"/middleware/mongo/getting-started",permalink:"/dddtdd-docs/middleware/mongo/getting-started",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1734870983e3,sidebarPosition:10,frontMatter:{},sidebar:"docSidebar",previous:{title:"Mongo\u4ecb\u7ecd",permalink:"/dddtdd-docs/middleware/mongo/"},next:{title:"install",permalink:"/dddtdd-docs/middleware/mongo/mongosh/install"}},l={},a=[{value:"database",id:"database",level:2},{value:"document",id:"document",level:2},{value:"dot notation",id:"dot-notation",level:3},{value:"Other Uses of the Document Structure",id:"other-uses-of-the-document-structure",level:3},{value:"Query Filter Documents",id:"query-filter-documents",level:4},{value:"Update Specification Documents",id:"update-specification-documents",level:4},{value:"Index Specification Documents",id:"index-specification-documents",level:4},{value:"Query API",id:"query-api",level:2},{value:"insert",id:"insert",level:2},{value:"query",id:"query",level:3},{value:"Array",id:"array",level:4},{value:"Project Fields",id:"project-fields",level:4},{value:"Update",id:"update",level:3},{value:"Delete",id:"delete",level:3},{value:"Aggregation",id:"aggregation",level:2},{value:"delete",id:"delete-1",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'db\r\n\r\nuse video\r\n\r\ndb.movies.insertOne(movie)\r\n\r\ndb.movies.find().pretty()\r\n\r\ndb.movies.findOne()\r\n\r\ndb.movies.updateOne({title: "Star Wars"}, {$set: {reviews: []}})\r\n\r\ndb.movies.deleteOne({title: "Star Wars"})\r\n\r\ndb.movies.deleteMany({title: "Star Wars"})\n'})}),"\n",(0,t.jsx)(n.h2,{id:"database",children:"database"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"use myDB\r\n\r\ndb.createCollection()\r\n\r\ndb.getCollectionInfos()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"document",children:"document"}),"\n",(0,t.jsx)(n.h3,{id:"dot-notation",children:"dot notation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:'// array\r\n"<array>.<index>"\r\n\r\n// object\r\n"<embedded document>.<field>"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"other-uses-of-the-document-structure",children:"Other Uses of the Document Structure"}),"\n",(0,t.jsx)(n.h4,{id:"query-filter-documents",children:"Query Filter Documents"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"{\r\n  <field1>: <value1>,\r\n  <field2>: { <operator>: <value> },\r\n  ...\r\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"update-specification-documents",children:"Update Specification Documents"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"{\r\n  <operator1>: { <field1>: <value1>, ... },\r\n  <operator2>: { <field2>: <value2>, ... },\r\n  ...\r\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"index-specification-documents",children:"Index Specification Documents"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"{ <field1>: <type1>, <field2>: <type2>, ...  }\n"})}),"\n",(0,t.jsx)(n.h2,{id:"query-api",children:"Query API"}),"\n",(0,t.jsx)(n.h2,{id:"insert",children:"insert"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.insertOne",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.insertOne"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.insertMany",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.insertMany"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'db.movies.insertOne(\r\n  {\r\n    title: "The Favourite",\r\n    genres: [ "Drama", "History" ],\r\n    runtime: 121,\r\n    rated: "R",\r\n    year: 2018,\r\n    directors: [ "Yorgos Lanthimos" ],\r\n    cast: [ "Olivia Colman", "Emma Stone", "Rachel Weisz" ],\r\n    type: "movie"\r\n  }\r\n)\r\n\r\ndb.movies.insertMany([\r\n   ***\r\n])\r\n\r\ndb.myNewCollection3.createIndex( { y: 1 } )\n'})}),"\n",(0,t.jsx)(n.h3,{id:"query",children:"query"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.find",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.find"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'db.movies.find()\r\n\r\n// Equality\r\ndb.movies.find( { "title": "Titanic" } )\r\n\r\n// Operators\r\ndb.movies.find( { rated: { $in: [ "PG", "PG-13" ] } } ) \r\n\r\n// and\r\ndb.movies.find( { countries: "Mexico", "imdb.rating": { $gte: 7 } } )\r\n\r\n// or\r\ndb.movies.find( {\r\n     year: 2010,\r\n     $or: [ { "awards.wins": { $gte: 5 } }, { genres: "Drama" } ]\r\n} )\n'})}),"\n",(0,t.jsx)(n.h4,{id:"array",children:"Array"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'// equality\r\ndb.inventory.find( { tags: ["red", "blank"] } )\r\n\r\n// without regard to order or other elements in the array\r\ndb.inventory.find( { tags: { $all: ["red", "blank"] } } )\r\n\r\n// at least one element with the specified value\r\ndb.inventory.find( { tags: "red" } )\r\n\r\n// elements that in some combination satisfy the query conditions\r\ndb.inventory.find( { dim_cm: { $gt: 15, $lt: 20 } } )\r\n\r\n// at least one array element satisfies all the specified criteria\r\ndb.inventory.find( { dim_cm: { $elemMatch: { $gt: 22, $lt: 30 } } } )\r\n\r\n// element at a particular index\r\ndb.inventory.find( { "dim_cm.1": { $gt: 25 } } )\r\n\r\n// number of elements\r\ndb.inventory.find( { "tags": { $size: 3 } } )\r\n\r\n// Equality matches on the whole embedded/nested document require \r\n// an exact match of the specified document, including the field order\r\ndb.inventory.find( { "instock": { warehouse: "A", qty: 5 } } )\r\n\r\n// Condition on a Field Embedded in an Array of Documents\r\ndb.inventory.find( { \'instock.qty\': { $lte: 20 } } )\r\n\r\ndb.inventory.find( { \'instock.0.qty\': { $lte: 20 } } )\r\n\r\n// Multiple Query Conditions on Nested Fields\r\ndb.inventory.find( { "instock": { $elemMatch: { qty: 5, warehouse: "A" } } } )\n'})}),"\n",(0,t.jsx)(n.h4,{id:"project-fields",children:"Project Fields"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'db.inventory.find( { status: "A" }, { item: 1, status: 1 } )\r\n\r\ndb.inventory.find( { status: "A" }, { item: 1, status: 1, _id: 0 } )\r\n\r\ndb.inventory.find( { status: "A" }, { status: 0, instock: 0 } )\r\n\r\ndb.inventory.find(\r\n   { status: "A" },\r\n   { item: 1, status: 1, "size.uom": 1 }\r\n)\r\n\r\ndb.inventory.find(\r\n   { status: "A" },\r\n   { "size.uom": 0 }\r\n)\r\n\r\ndb.inventory.find( { status: "A" }, { item: 1, status: 1, "instock.qty": 1 } )\r\n\r\ndb.inventory.find( { status: "A" }, { item: 1, status: 1, instock: { $slice: -1 } } )\n'})}),"\n",(0,t.jsx)(n.h3,{id:"update",children:"Update"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.updateOne",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.updateOne"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.updateMany",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.updateMany"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.replaceOne",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.replaceOne"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'{\r\n  <update operator>: { <field1>: <value1>, ... },\r\n  <update operator>: { <field2>: <value2>, ... },\r\n  ...\r\n} \r\n\r\ndb.movies.updateOne( { title: "Tag" },\r\n{\r\n  $set: {\r\n    plot: "One month every year, five highly competitive friends\r\n           hit the ground running for a no-holds-barred game of tag"\r\n  }\r\n  { $currentDate: { lastUpdated: true } }\r\n})\r\n\r\ndb.listingsAndReviews.updateMany(\r\n  { security_deposit: { $lt: 100 } },\r\n  {\r\n    $set: { security_deposit: 100, minimum_nights: 1 }\r\n  }\r\n)\r\n\r\n// replace the entire content of a document except for the _id field\r\ndb.accounts.replaceOne(\r\n  { account_id: 371138 },\r\n  { account_id: 893421, limit: 5000, products: [ "Investment", "Brokerage" ] }\r\n)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"delete",children:"Delete"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.deleteOne",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.deleteOne"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.deleteMany",children:"https://www.mongodb.com/docs/manual/reference/method/db.collection.deleteMany"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'db.movies.deleteMany({})\r\n\r\ndb.movies.deleteOne( { cast: "Brad Pitt" } )\r\n\r\ndb.movies.deleteMany( { title: "Titanic" } )\n'})}),"\n",(0,t.jsx)(n.h2,{id:"aggregation",children:"Aggregation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'db.<collection>.aggregate([\r\n  {\r\n    <$stage1>\r\n  },\r\n  {\r\n    <$stage2>\r\n  }\r\n  ...\r\n])\r\n\r\ndb.movies.aggregate([\r\n\r\n  // First Stage\r\n\r\n  { $project: { _id: 0, genres: 1, imdb: 1, title: 1 } },\r\n\r\n  // Second Stage\r\n\r\n  { $unwind: "$genres" },\r\n\r\n  // Third Stage\r\n\r\n  { $group:\r\n    { _id: "$genres",\r\n      averageGenreRating: { $avg: "$imdb.rating" }\r\n    }\r\n  },\r\n\r\n   // Fourth Stage\r\n\r\n   { $sort: { averageGenreRating: -1 } }\r\n] )\n'})}),"\n",(0,t.jsx)(n.h2,{id:"delete-1",children:"delete"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'movies_coll.delete_one({"id": 4})\r\n\r\nmovies_coll.delete_many({"year": 1984})\r\n\r\nmovies_coll.drop()\n'})})]})}function m(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>s});var t=r(96540);const d={},i=t.createContext(d);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);