"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[31899],{78120:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>s,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var r=o(74848),a=o(28453);const i={},t="pydantic_core.core_schema",c={id:"programming-languages/python/libs/pydantic/pydantic_core_schema",title:"pydantic_core.core_schema",description:"WhenUsed",source:"@site/docs/00400-programming-languages/python/libs/pydantic/110-pydantic_core_schema.md",sourceDirName:"00400-programming-languages/python/libs/pydantic",slug:"/programming-languages/python/libs/pydantic/pydantic_core_schema",permalink:"/dddtdd-docs/programming-languages/python/libs/pydantic/pydantic_core_schema",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1734870983e3,sidebarPosition:110,frontMatter:{},sidebar:"docSidebar",previous:{title:"Validators",permalink:"/dddtdd-docs/programming-languages/python/libs/pydantic/validators"},next:{title:"Architecture",permalink:"/dddtdd-docs/programming-languages/python/libs/pydantic/architecture"}},s={},l=[{value:"WhenUsed",id:"whenused",level:2},{value:"SerializationInfo",id:"serializationinfo",level:2},{value:"ValidationInfo",id:"validationinfo",level:2},{value:"datetime_schema",id:"datetime_schema",level:2},{value:"list_schema",id:"list_schema",level:2},{value:"no_info_before_validator_function",id:"no_info_before_validator_function",level:2},{value:"with_info_before_validator_function",id:"with_info_before_validator_function",level:2},{value:"no_info_after_validator_function",id:"no_info_after_validator_function",level:2},{value:"no_info_wrap_validator_function",id:"no_info_wrap_validator_function",level:2},{value:"no_info_plain_validator_function",id:"no_info_plain_validator_function",level:2},{value:"union_schema",id:"union_schema",level:2},{value:"chain_schema",id:"chain_schema",level:2},{value:"json_or_python_schema",id:"json_or_python_schema",level:2},{value:"model_field",id:"model_field",level:2},{value:"model_fields_schema",id:"model_fields_schema",level:2},{value:"model_schema",id:"model_schema",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"pydantic_corecore_schema",children:"pydantic_core.core_schema"}),"\n",(0,r.jsx)(e.h2,{id:"whenused",children:"WhenUsed"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:'WhenUsed = Literal[\r\n    "always", "unless-none", "json", "json-unless-none"\r\n]\n'})}),"\n",(0,r.jsx)(e.h2,{id:"serializationinfo",children:"SerializationInfo"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"context: Any | None"})}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"validationinfo",children:"ValidationInfo"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"context: Any | None"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"config: CoreConfig | None"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"mode: Literal['python', 'json']"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"data: Dict[str, Any]"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"field_name: str | None"})}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"datetime_schema",children:"datetime_schema"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:'datetime_schema(\r\n    *,\r\n    strict: bool | None = None,\r\n    le: datetime | None = None,\r\n    ge: datetime | None = None,\r\n    lt: datetime | None = None,\r\n    gt: datetime | None = None,\r\n    now_op: Literal["past", "future"] | None = None,\r\n    tz_constraint: (\r\n        Literal["aware", "naive"] | int | None\r\n    ) = None,\r\n    now_utc_offset: int | None = None,\r\n    microseconds_precision: Literal[\r\n        "truncate", "error"\r\n    ] = "truncate",\r\n    ref: str | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> DatetimeSchema\n'})}),"\n",(0,r.jsx)(e.h2,{id:"list_schema",children:"list_schema"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"list_schema(\r\n    items_schema: CoreSchema | None = None,\r\n    *,\r\n    min_length: int | None = None,\r\n    max_length: int | None = None,\r\n    fail_fast: bool | None = None,\r\n    strict: bool | None = None,\r\n    ref: str | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: IncExSeqOrElseSerSchema | None = None\r\n) -> ListSchema\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"from pydantic_core import SchemaValidator, core_schema\r\n\r\nschema = core_schema.list_schema(core_schema.int_schema(), min_length=0, max_length=10)\r\nv = SchemaValidator(schema)\r\nassert v.validate_python(['4']) == [4]\n"})}),"\n",(0,r.jsx)(e.h2,{id:"no_info_before_validator_function",children:"no_info_before_validator_function"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"no_info_before_validator_function(\r\n    function: NoInfoValidatorFunction,\r\n    schema: CoreSchema,\r\n    *,\r\n    ref: str | None = None,\r\n    json_schema_input_schema: CoreSchema | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> BeforeValidatorFunctionSchema\n"})}),"\n",(0,r.jsx)(e.p,{children:"Returns a schema that calls a validator function before validating, no info argument is provided"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"from pydantic_core import SchemaValidator, core_schema\r\n\r\ndef fn(v: bytes) -> str:\r\n    return v.decode() + 'world'\r\n\r\nfunc_schema = core_schema.no_info_before_validator_function(\r\n    function=fn, schema=core_schema.str_schema()\r\n)\r\nschema = core_schema.typed_dict_schema({'a': core_schema.typed_dict_field(func_schema)})\r\n\r\nv = SchemaValidator(schema)\r\nassert v.validate_python({'a': b'hello '}) == {'a': 'hello world'}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"with_info_before_validator_function",children:"with_info_before_validator_function"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"with_info_before_validator_function(\r\n    function: WithInfoValidatorFunction,\r\n    schema: CoreSchema,\r\n    *,\r\n    field_name: str | None = None,\r\n    ref: str | None = None,\r\n    json_schema_input_schema: CoreSchema | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> BeforeValidatorFunctionSchema\n"})}),"\n",(0,r.jsx)(e.h2,{id:"no_info_after_validator_function",children:"no_info_after_validator_function"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"no_info_after_validator_function(\r\n    function: NoInfoValidatorFunction,\r\n    schema: CoreSchema,\r\n    *,\r\n    ref: str | None = None,\r\n    json_schema_input_schema: CoreSchema | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> AfterValidatorFunctionSchema\n"})}),"\n",(0,r.jsx)(e.p,{children:"Returns a schema that calls a validator function after validating, no info argument is provided"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"from pydantic_core import SchemaValidator, core_schema\r\n\r\ndef fn(v: str) -> str:\r\n    return v + 'world'\r\n\r\nfunc_schema = core_schema.no_info_after_validator_function(fn, core_schema.str_schema())\r\nschema = core_schema.typed_dict_schema({'a': core_schema.typed_dict_field(func_schema)})\r\n\r\nv = SchemaValidator(schema)\r\nassert v.validate_python({'a': b'hello '}) == {'a': 'hello world'}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"no_info_wrap_validator_function",children:"no_info_wrap_validator_function"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"no_info_wrap_validator_function(\r\n    function: NoInfoWrapValidatorFunction,\r\n    schema: CoreSchema,\r\n    *,\r\n    ref: str | None = None,\r\n    json_schema_input_schema: CoreSchema | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> WrapValidatorFunctionSchema\n"})}),"\n",(0,r.jsxs)(e.p,{children:["Returns a schema which calls a function with a ",(0,r.jsx)(e.code,{children:"validator"}),' callable argument which can optionally be used to call inner validation with the function logic, this is much like the "onion" implementation of middleware in many popular web frameworks, no info argument is passed']}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"from pydantic_core import SchemaValidator, core_schema\r\n\r\ndef fn(\r\n    v: str,\r\n    validator: core_schema.ValidatorFunctionWrapHandler,\r\n) -> str:\r\n    return validator(input_value=v) + 'world'\r\n\r\nschema = core_schema.no_info_wrap_validator_function(\r\n    function=fn, schema=core_schema.str_schema()\r\n)\r\nv = SchemaValidator(schema)\r\nassert v.validate_python('hello ') == 'hello world'\n"})}),"\n",(0,r.jsx)(e.h2,{id:"no_info_plain_validator_function",children:"no_info_plain_validator_function"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"no_info_plain_validator_function(\r\n    function: NoInfoValidatorFunction,\r\n    *,\r\n    ref: str | None = None,\r\n    json_schema_input_schema: CoreSchema | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> PlainValidatorFunctionSchema\n"})}),"\n",(0,r.jsx)(e.p,{children:"Returns a schema that uses the provided function for validation, no info argument is passed"}),"\n",(0,r.jsx)(e.h2,{id:"union_schema",children:"union_schema"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:'union_schema(\r\n    choices: list[CoreSchema | tuple[CoreSchema, str]],\r\n    *,\r\n    auto_collapse: bool | None = None,\r\n    custom_error_type: str | None = None,\r\n    custom_error_message: str | None = None,\r\n    custom_error_context: (\r\n        dict[str, str | int] | None\r\n    ) = None,\r\n    mode: Literal["smart", "left_to_right"] | None = None,\r\n    strict: bool | None = None,\r\n    ref: str | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> UnionSchema\n'})}),"\n",(0,r.jsx)(e.h2,{id:"chain_schema",children:"chain_schema"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"chain_schema(\r\n    steps: list[CoreSchema],\r\n    *,\r\n    ref: str | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> ChainSchema\n"})}),"\n",(0,r.jsx)(e.h2,{id:"json_or_python_schema",children:"json_or_python_schema"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"json_or_python_schema(\r\n    json_schema: CoreSchema,\r\n    python_schema: CoreSchema,\r\n    *,\r\n    ref: str | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> JsonOrPythonSchema\n"})}),"\n",(0,r.jsx)(e.h2,{id:"model_field",children:"model_field"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"model_field(\r\n    schema: CoreSchema,\r\n    *,\r\n    validation_alias: (\r\n        str | list[str | int] | list[list[str | int]] | None\r\n    ) = None,\r\n    serialization_alias: str | None = None,\r\n    serialization_exclude: bool | None = None,\r\n    frozen: bool | None = None,\r\n    metadata: Dict[str, Any] | None = None\r\n) -> ModelField\n"})}),"\n",(0,r.jsx)(e.h2,{id:"model_fields_schema",children:"model_fields_schema"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"model_fields_schema(\r\n    fields: Dict[str, ModelField],\r\n    *,\r\n    model_name: str | None = None,\r\n    computed_fields: list[ComputedField] | None = None,\r\n    strict: bool | None = None,\r\n    extras_schema: CoreSchema | None = None,\r\n    extra_behavior: ExtraBehavior | None = None,\r\n    populate_by_name: bool | None = None,\r\n    from_attributes: bool | None = None,\r\n    ref: str | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> ModelFieldsSchema\n"})}),"\n",(0,r.jsx)(e.h2,{id:"model_schema",children:"model_schema"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:'model_schema(\r\n    cls: Type[Any],\r\n    schema: CoreSchema,\r\n    *,\r\n    generic_origin: Type[Any] | None = None,\r\n    custom_init: bool | None = None,\r\n    root_model: bool | None = None,\r\n    post_init: str | None = None,\r\n    revalidate_instances: (\r\n        Literal["always", "never", "subclass-instances"]\r\n        | None\r\n    ) = None,\r\n    strict: bool | None = None,\r\n    frozen: bool | None = None,\r\n    extra_behavior: ExtraBehavior | None = None,\r\n    config: CoreConfig | None = None,\r\n    ref: str | None = None,\r\n    metadata: Dict[str, Any] | None = None,\r\n    serialization: SerSchema | None = None\r\n) -> ModelSchema\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-py",children:"from pydantic_core import CoreConfig, SchemaValidator, core_schema\r\n\r\nclass MyModel:\r\n    __slots__ = (\r\n        '__dict__',\r\n        '__pydantic_fields_set__',\r\n        '__pydantic_extra__',\r\n        '__pydantic_private__',\r\n    )\r\n\r\nschema = core_schema.model_schema(\r\n    cls=MyModel,\r\n    config=CoreConfig(str_max_length=5),\r\n    schema=core_schema.model_fields_schema(\r\n        fields={'a': core_schema.model_field(core_schema.str_schema())},\r\n    ),\r\n)\r\nv = SchemaValidator(schema)\r\nassert v.isinstance_python({'a': 'hello'}) is True\r\nassert v.isinstance_python({'a': 'too long'}) is False\n"})})]})}function h(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},28453:(n,e,o)=>{o.d(e,{R:()=>t,x:()=>c});var r=o(96540);const a={},i=r.createContext(a);function t(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:t(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);