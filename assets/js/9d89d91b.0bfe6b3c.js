"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[3509],{38449:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>t,metadata:()=>a,toc:()=>d});var o=r(74848),i=r(28453);const t={},s="Navigation Guards",a={id:"frontend/vue3/router/advanced/navigation-guards",title:"Navigation Guards",description:"guard navigations either by redirecting it or canceling it",source:"@site/docs/00200-frontend/vue3/030-router/030-advanced/010-navigation-guards.md",sourceDirName:"00200-frontend/vue3/030-router/030-advanced",slug:"/frontend/vue3/router/advanced/navigation-guards",permalink:"/dddtdd-docs/frontend/vue3/router/advanced/navigation-guards",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1720187019e3,sidebarPosition:10,frontMatter:{},sidebar:"docSidebar",previous:{title:"Different History modes",permalink:"/dddtdd-docs/frontend/vue3/router/essentials/history-mode"},next:{title:"Route Meta Fields",permalink:"/dddtdd-docs/frontend/vue3/router/advanced/meta"}},l={},d=[{value:"Global Before Guards",id:"global-before-guards",level:2},{value:"Global After Hooks",id:"global-after-hooks",level:2},{value:"Global injections within guards",id:"global-injections-within-guards",level:2},{value:"In-Component Guards",id:"in-component-guards",level:2},{value:"The Full Navigation Resolution Flow",id:"the-full-navigation-resolution-flow",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"navigation-guards",children:"Navigation Guards"}),"\n",(0,o.jsxs)(n.p,{children:["guard navigations either by ",(0,o.jsx)(n.strong,{children:"redirecting it or canceling it"})]}),"\n",(0,o.jsx)(n.h2,{id:"global-before-guards",children:"Global Before Guards"}),"\n",(0,o.jsxs)(n.p,{children:["Guards may be resolved asynchronously, and the navigation is considered ",(0,o.jsx)(n.strong,{children:"pending"})," before all hooks have been resolved"]}),"\n",(0,o.jsx)(n.p,{children:"Every guard function receives two arguments:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["to: the target route location in a ",(0,o.jsx)(n.strong,{children:"normalized format"})," being navigated to."]}),"\n",(0,o.jsx)(n.li,{children:"from: the current route location in a normalized format being navigated away from."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const router = createRouter({ ... })\r\n\r\nrouter.beforeEach((to, from) => {\r\n  // ...\r\n  // explicitly return false to cancel the navigation\r\n  return false\r\n})\n"})}),"\n",(0,o.jsx)(n.p,{children:"can optionally return any of the following values"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"false"}),"\n",(0,o.jsx)(n.li,{children:"A Route Location"}),"\n",(0,o.jsx)(n.li,{children:"throw an Error"}),"\n",(0,o.jsx)(n.li,{children:"nothing, undefined or true: the navigation is validated"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"router.beforeEach(async (to, from) => {\r\n  // canUserAccess() returns `true` or `false`\r\n  const canAccess = await canUserAccess(to)\r\n  if (!canAccess) return '/login'\r\n})\n"})}),"\n",(0,o.jsx)(n.h2,{id:"global-after-hooks",children:"Global After Hooks"}),"\n",(0,o.jsx)(n.p,{children:"They are useful for analytics, changing the title of the page, accessibility features like announcing the page and many other things"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"router.afterEach((to, from, failure) => {\r\n  if (!failure) sendToAnalytics(to.fullPath)\r\n})\n"})}),"\n",(0,o.jsx)(n.h2,{id:"global-injections-within-guards",children:"Global injections within guards"}),"\n",(0,o.jsxs)(n.p,{children:["Since Vue 3.3, it is possible to use ",(0,o.jsx)(n.code,{children:"inject()"})," within navigation guards. This is useful for injecting global properties like the ",(0,o.jsx)(n.strong,{children:"pinia stores"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// main.ts\r\nconst app = createApp(App)\r\napp.provide('global', 'hello injections')\r\n\r\n// router.ts or main.ts\r\nrouter.beforeEach((to, from) => {\r\n  const global = inject('global') // 'hello injections'\r\n  // a pinia store\r\n  const userStore = useAuthStore()\r\n  // ...\r\n})\n"})}),"\n",(0,o.jsx)(n.h2,{id:"in-component-guards",children:"In-Component Guards"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Using the composition API: you can add update and leave guards through ",(0,o.jsx)(n.code,{children:"onBeforeRouteUpdate"})," and ",(0,o.jsx)(n.code,{children:"onBeforeRouteLeave"})," respectively"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"the-full-navigation-resolution-flow",children:"The Full Navigation Resolution Flow"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Navigation triggered."}),"\n",(0,o.jsxs)(n.li,{children:["Call ",(0,o.jsx)(n.code,{children:"beforeRouteLeave"})," guards in deactivated components."]}),"\n",(0,o.jsxs)(n.li,{children:["Call global ",(0,o.jsx)(n.code,{children:"beforeEach"})," guards."]}),"\n",(0,o.jsxs)(n.li,{children:["Call ",(0,o.jsx)(n.code,{children:"beforeRouteUpdate"})," guards in reused components."]}),"\n",(0,o.jsxs)(n.li,{children:["Call ",(0,o.jsx)(n.code,{children:"beforeEnter"})," in route configs."]}),"\n",(0,o.jsx)(n.li,{children:"Resolve async route components."}),"\n",(0,o.jsxs)(n.li,{children:["Call ",(0,o.jsx)(n.code,{children:"beforeRouteEnter"})," in activated components."]}),"\n",(0,o.jsxs)(n.li,{children:["Call global ",(0,o.jsx)(n.code,{children:"beforeResolve"})," guards."]}),"\n",(0,o.jsx)(n.li,{children:"Navigation is confirmed."}),"\n",(0,o.jsxs)(n.li,{children:["Call global ",(0,o.jsx)(n.code,{children:"afterEach"})," hooks."]}),"\n",(0,o.jsx)(n.li,{children:"DOM updates triggered."}),"\n",(0,o.jsxs)(n.li,{children:["Call callbacks passed to next in ",(0,o.jsx)(n.code,{children:"beforeRouteEnter"})," guards with instantiated instances"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var o=r(96540);const i={},t=o.createContext(i);function s(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);