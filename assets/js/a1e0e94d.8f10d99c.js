"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[98452],{37291:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>c,toc:()=>d});var t=s(74848),o=s(28453);const a={},l=void 0,c={id:"frontend/vue3/element-plus/components/feedback/message",title:"message",description:"message.ts",source:"@site/docs/00200-frontend/vue3/element-plus/components/0400-feedback/0400-message.md",sourceDirName:"00200-frontend/vue3/element-plus/components/0400-feedback",slug:"/frontend/vue3/element-plus/components/feedback/message",permalink:"/dddtdd-docs/frontend/vue3/element-plus/components/feedback/message",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1720187019e3,sidebarPosition:400,frontMatter:{},sidebar:"docSidebar",previous:{title:"loading",permalink:"/dddtdd-docs/frontend/vue3/element-plus/components/feedback/loading"},next:{title:"sass",permalink:"/dddtdd-docs/frontend/css/sass"}},r={},d=[{value:"message.ts",id:"messagets",level:2},{value:"messageProps",id:"messageprops",level:3},{value:"instance.ts",id:"instancets",level:2},{value:"message.vue",id:"messagevue",level:2},{value:"state",id:"state",level:3},{value:"onClose\u56de\u8c03\u89e6\u53d1",id:"onclose\u56de\u8c03\u89e6\u53d1",level:3},{value:"class &amp; style &amp; \u81ea\u52a8\u5173\u95edtimer\u8bbe\u7f6e",id:"class--style--\u81ea\u52a8\u5173\u95edtimer\u8bbe\u7f6e",level:3},{value:"content",id:"content",level:3},{value:"method.ts",id:"methodts",level:2}];function i(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"messagets",children:"message.ts"}),"\n",(0,t.jsx)(n.h3,{id:"messageprops",children:"messageProps"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export const messageProps = buildProps({\n\n  center: {\n    type: Boolean,\n    default: messageDefaults.center,\n  },\n\n  duration: {\n    type: Number,\n    default: messageDefaults.duration,\n  },\n  \n  message: {\n    type: definePropType<string | VNode | (() => VNode)>([\n      String,\n      Object,\n      Function,\n    ]),\n    default: messageDefaults.message,\n  },\n  \n  showClose: {\n    type: Boolean,\n    default: messageDefaults.showClose,\n  },\n  \n  type: {\n    type: String,\n    values: messageTypes,\n    default: messageDefaults.type,\n  },\n\n"})}),"\n",(0,t.jsx)(n.h2,{id:"instancets",children:"instance.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export type MessageContext = {\n  id: string\n  vnode: VNode\n  handler: MessageHandler\n  vm: ComponentInternalInstance\n  props: Mutable<MessageProps>\n}\n\nexport const instances: MessageContext[] = shallowReactive([])\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"getInstance = (id: string)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"getLastOffset = (id: string): number"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"messagevue",children:"message.vue"}),"\n",(0,t.jsx)(n.h3,{id:"state",children:"state"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"const ns = useNamespace('message')\n\nconst messageRef = ref<HTMLDivElement>()\nconst visible = ref(false)\nconst height = ref(0)\n\nlet stopTimer: (() => void) | undefined = undefined\n\nconst badgeType = computed<BadgeProps['type']>(() =>\n  props.type ? (props.type === 'error' ? 'danger' : props.type) : 'info'\n)\nconst typeClass = computed(() => {\n  const type = props.type\n  return { [ns.bm('icon', type)]: type && TypeComponentsMap[type] }\n})\nconst iconComponent = computed(\n  () => props.icon || TypeComponentsMap[props.type] || ''\n)\n\nconst lastOffset = computed(() => getLastOffset(props.id))\nconst offset = computed(() => props.offset + lastOffset.value)\nconst bottom = computed((): number => height.value + offset.value)\nconst customStyle = computed<CSSProperties>(() => ({\n  top: `${offset.value}px`,\n  zIndex: props.zIndex,\n}))\n"})}),"\n",(0,t.jsx)(n.h3,{id:"onclose\u56de\u8c03\u89e6\u53d1",children:"onClose\u56de\u8c03\u89e6\u53d1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'  <transition\n    :name="ns.b(\'fade\')"\n    @before-leave="onClose"\n    @after-leave="$emit(\'destroy\')"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"class--style--\u81ea\u52a8\u5173\u95edtimer\u8bbe\u7f6e",children:"class & style & \u81ea\u52a8\u5173\u95edtimer\u8bbe\u7f6e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'    <div\n      v-show="visible"\n      :id="id"\n      ref="messageRef"\n      :class="[\n        ns.b(),\n        { [ns.m(type)]: type && !icon },\n        ns.is(\'center\', center),\n        ns.is(\'closable\', showClose),\n        customClass,\n      ]"\n      :style="customStyle"\n      role="alert"\n      @mouseenter="clearTimer"\n      @mouseleave="startTimer"\n    >\n'})}),"\n",(0,t.jsx)(n.h3,{id:"content",children:"content"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'        <p v-if="!dangerouslyUseHTMLString" :class="ns.e(\'content\')">\n          {{ message }}\n        </p>\n\n      <el-icon v-if="showClose" :class="ns.e(\'closeBtn\')" @click.stop="close">\n        <Close />\n      </el-icon>\n'})}),"\n",(0,t.jsx)(n.h2,{id:"methodts",children:"method.ts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"messageTypes.forEach((type) => {\n  message[type] = (options = {}, appContext) => {\n    const normalized = normalizeOptions(options)\n    return message({ ...normalized, type }, appContext)\n  }\n})\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"const message: MessageFn &\n  Partial<Message> & { _context: AppContext | null } = (\n  options = {},\n  context\n) => {\n\n  const instance = createMessage(normalized, context)\n\n  instances.push(instance)\n  return instance.handler\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(i,{...e})}):i(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var t=s(96540);const o={},a=t.createContext(o);function l(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);