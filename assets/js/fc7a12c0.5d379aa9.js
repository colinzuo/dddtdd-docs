"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[15866],{56667:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var r=t(74848),s=t(28453);const a={},o="Write Data to MongoDB",i={id:"middleware/mongo/pymongo/write-operations",title:"Write Data to MongoDB",description:"Insert Documents",source:"@site/docs/00600-middleware/mongo/pymongo/040-write-operations.md",sourceDirName:"00600-middleware/mongo/pymongo",slug:"/middleware/mongo/pymongo/write-operations",permalink:"/dddtdd-docs/middleware/mongo/pymongo/write-operations",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1734870983e3,sidebarPosition:40,frontMatter:{},sidebar:"docSidebar",previous:{title:"Databases and Collections",permalink:"/dddtdd-docs/middleware/mongo/pymongo/databases-collections"},next:{title:"Read Data from MongoDB",permalink:"/dddtdd-docs/middleware/mongo/pymongo/read"}},c={},l=[{value:"Insert Documents",id:"insert-documents",level:2},{value:"Insert One Document",id:"insert-one-document",level:3},{value:"Insert Multiple Documents",id:"insert-multiple-documents",level:3},{value:"Update Documents",id:"update-documents",level:2},{value:"Update One Document",id:"update-one-document",level:3},{value:"Update Many Documents",id:"update-many-documents",level:3},{value:"Replace Documents",id:"replace-documents",level:2},{value:"Delete Documents",id:"delete-documents",level:2},{value:"transactions",id:"transactions",level:2},{value:"Methods",id:"methods",level:3},{value:"Example",id:"example",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"write-data-to-mongodb",children:"Write Data to MongoDB"}),"\n",(0,r.jsx)(n.h2,{id:"insert-documents",children:"Insert Documents"}),"\n",(0,r.jsx)(n.h3,{id:"insert-one-document",children:"Insert One Document"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'sample_restaurants.restaurants.insert_one({"name" : "Mongo\'s Burgers"})\n'})}),"\n",(0,r.jsx)(n.h3,{id:"insert-multiple-documents",children:"Insert Multiple Documents"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'document_list = [\r\n   { "name" : "Mongo\'s Burgers" },\r\n   { "name" : "Mongo\'s Pizza" }\r\n]\r\n\r\nsample_restaurants.restaurants.insert_many(document_list)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"update-documents",children:"Update Documents"}),"\n",(0,r.jsx)(n.h3,{id:"update-one-document",children:"Update One Document"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"restaurants = database[\"restaurants\"]\r\n\r\nquery_filter = {'name' : 'Bagels N Buns'}\r\nupdate_operation = { '$set' : \r\n    { 'name' : '2 Bagels 2 Buns' }\r\n}\r\n\r\nresult = restaurants.update_one(query_filter, update_operation)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"update-many-documents",children:"Update Many Documents"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"restaurants = database[\"restaurants\"]\r\n\r\nquery_filter = {'cuisine' : 'Pizza'}\r\nupdate_operation = { '$set' : \r\n    { 'cuisine' : 'Pasta' }\r\n}\r\n\r\nresult = restaurants.update_many(query_filter, update_operation)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"replace-documents",children:"Replace Documents"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'restaurants = database["restaurants"]\r\n\r\nquery_filter = {"name" : "Pizza Town"}\r\nreplace_document = { "name" : "Mongo\'s Pizza",\r\n                     "cuisine" : "Pizza",\r\n                     "address" : {\r\n                         "street" : "123 Pizza St",\r\n                         "zipCode" : "10003"\r\n                     },\r\n                     "borough" : "Manhattan"\r\n                   }\r\n\r\nresult = restaurants.replace_one(query_filter, replace_document)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"delete-documents",children:"Delete Documents"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'query_filter = { "name": "Ready Penny Inn" }\r\n\r\nresult = restaurants.delete_one(query_filter)\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'query_filter = { "borough": "Brooklyn" }\r\n\r\nresult = restaurants.delete_many(query_filter)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"transactions",children:"transactions"}),"\n",(0,r.jsxs)(n.p,{children:["In MongoDB, transactions run within ",(0,r.jsx)(n.strong,{children:"logical sessions"}),". A session is a grouping of related read or write operations that you intend to run sequentially. Sessions enable ",(0,r.jsx)(n.strong,{children:"causal consistency"})," for a group of operations and allow you to run operations in an ",(0,r.jsx)(n.strong,{children:"ACID-compliant transaction"}),", which is a transaction that meets an expectation of atomicity, consistency, isolation, and durability."]}),"\n",(0,r.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"start_session()"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"start_transaction()"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"abort_transaction()"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"commit_transaction()"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"with_transaction()"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"end_session()"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'# Establishes a connection to the MongoDB server\r\nclient = MongoClient("<connection string>")\r\n\r\n# Defines the database and collection\r\nrestaurants_db = client["sample_restaurants"]\r\nrestaurants_collection = restaurants_db["restaurants"]\r\n\r\n# Function performs the transaction\r\ndef insert_documents(session):\r\n    restaurants_collection_with_session = restaurants_collection.with_options(\r\n        write_concern=WriteConcern("majority"),\r\n        read_concern=ReadConcern("local")\r\n    )\r\n    \r\n    # Inserts documents within the transaction\r\n    restaurants_collection_with_session.insert_one(\r\n        {"name": "PyMongo Pizza", "cuisine": "Pizza"}, session=session\r\n    )\r\n    restaurants_collection_with_session.insert_one(\r\n        {"name": "PyMongo Burger", "cuisine": "Burger"}, session=session\r\n    )\r\n\r\n# Starts a client session\r\nwith client.start_session() as session:\r\n    try:\r\n        # Uses the with_transaction method to start a transaction, execute the callback, and commit (or abort on error).\r\n        session.with_transaction(insert_documents)\r\n        print("Transaction succeeded")\r\n    except (ConnectionFailure, OperationFailure) as e:\r\n        print(f"Transaction failed: {e}")\r\n\r\n# Closes the client connection\r\nclient.close()\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var r=t(96540);const s={},a=r.createContext(s);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);