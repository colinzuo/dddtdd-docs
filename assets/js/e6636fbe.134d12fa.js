"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[8496],{68077:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>p});var i=t(74848),a=t(28453);const s={},o=void 0,r={id:"programming-languages/python/pep/2017-0561-Distributing-and-Packaging-Type-Information",title:"2017-0561-Distributing-and-Packaging-Type-Information",description:"https://peps.python.org/pep-0561/",source:"@site/docs/00400-programming-languages/python/pep/2017-0561-Distributing-and-Packaging-Type-Information.md",sourceDirName:"00400-programming-languages/python/pep",slug:"/programming-languages/python/pep/2017-0561-Distributing-and-Packaging-Type-Information",permalink:"/dddtdd-docs/programming-languages/python/pep/2017-0561-Distributing-and-Packaging-Type-Information",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1730173012e3,frontMatter:{},sidebar:"docSidebar",previous:{title:"2017-0544-Protocols-Structural-subtyping",permalink:"/dddtdd-docs/programming-languages/python/pep/2017-0544-Protocols-Structural-subtyping"},next:{title:"2017-0567-Context-Variables",permalink:"/dddtdd-docs/programming-languages/python/pep/2017-0567-Context-Variables"}},c={},p=[{value:"Specification",id:"specification",level:2},{value:"Packaging Type Information",id:"packaging-type-information",level:3},{value:"Stub-only Packages",id:"stub-only-packages",level:4},{value:"Type Checker Module Resolution Order",id:"type-checker-module-resolution-order",level:3},{value:"Partial Stub Packages",id:"partial-stub-packages",level:3}];function l(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://peps.python.org/pep-0561/",children:"https://peps.python.org/pep-0561/"})}),"\n",(0,i.jsx)(n.h2,{id:"specification",children:"Specification"}),"\n",(0,i.jsx)(n.p,{children:"This PEP recognizes three types of packages that users of typing wish to create:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The package maintainer would like to add type information ",(0,i.jsx)(n.strong,{children:"inline"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The package maintainer would like to add type information ",(0,i.jsx)(n.strong,{children:"via stubs"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["A third party or package maintainer would like to share ",(0,i.jsx)(n.strong,{children:"stub files"})," for a package, but the maintainer does not want to include them in the source of the package."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The two major parts of this specification are the ",(0,i.jsx)(n.strong,{children:"packaging"})," specifications and the ",(0,i.jsx)(n.strong,{children:"resolution"})," order for resolving module type information"]}),"\n",(0,i.jsx)(n.h3,{id:"packaging-type-information",children:"Packaging Type Information"}),"\n",(0,i.jsxs)(n.p,{children:["Package maintainers who wish to support type checking of their code MUST add a marker file named ",(0,i.jsx)(n.strong,{children:"py.typed"})," to their package supporting typing"]}),"\n",(0,i.jsxs)(n.p,{children:["To have this file installed with the package, maintainers can use existing packaging options such as ",(0,i.jsx)(n.strong,{children:"package_data"})," in distutils"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"setup(\r\n    ...,\r\n    package_data = {\r\n        'foopkg': ['py.typed'],\r\n    },\r\n    ...,\r\n    )\n"})}),"\n",(0,i.jsx)(n.h4,{id:"stub-only-packages",children:"Stub-only Packages"}),"\n",(0,i.jsxs)(n.p,{children:["The name of the stub package ",(0,i.jsx)(n.strong,{children:"MUST"})," follow the scheme ",(0,i.jsx)(n.code,{children:"foopkg-stubs"})," for type stubs for the package named ",(0,i.jsx)(n.code,{children:"foopkg"}),". Note that for stub-only packages adding a ",(0,i.jsx)(n.code,{children:"py.typed"})," marker is ",(0,i.jsx)(n.strong,{children:"not needed"})," since the name ",(0,i.jsx)(n.code,{children:"*-stubs"})," is enough to indicate it is a source of typing information."]}),"\n",(0,i.jsx)(n.h3,{id:"type-checker-module-resolution-order",children:"Type Checker Module Resolution Order"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Stubs or Python source manually put in the beginning of the path. Type checkers SHOULD provide this to allow the user complete control of which stubs to use, and to patch broken stubs/inline types from packages. In mypy the ",(0,i.jsx)(n.code,{children:"$MYPYPATH"})," environment variable can be used for this."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"User code"})," - the files the type checker is running on."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stub packages"})," - these packages SHOULD supersede any installed inline package. They can be found at foopkg-stubs for package foopkg."]}),"\n",(0,i.jsxs)(n.li,{children:["Packages with a ",(0,i.jsx)(n.code,{children:"py.typed"})," marker file - if there is nothing overriding the installed package, and it opts into type checking, the types bundled with the package SHOULD be used (be they in .pyi type stub files or inline in .py files)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Typeshed"})," (if used) - Provides the stdlib types and several third party libraries"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"partial-stub-packages",children:"Partial Stub Packages"}),"\n",(0,i.jsxs)(n.p,{children:["Many ",(0,i.jsx)(n.strong,{children:"stub packages"})," will only have part of the type interface for libraries completed, especially initially. For the benefit of type checking and code editors, packages can be ",(0,i.jsx)(n.strong,{children:"\u201cpartial\u201d"}),". This means modules not found in the stub package SHOULD be searched for in parts four and five of the module resolution order above, namely ",(0,i.jsx)(n.strong,{children:"inline packages and typeshed"})]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var i=t(96540);const a={},s=i.createContext(a);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);