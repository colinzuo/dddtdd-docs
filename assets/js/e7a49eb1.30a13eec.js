"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[745],{44940:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>u,toc:()=>c});var r=t(74848),o=t(28453);const s={},a="Vue Router and the Composition API",u={id:"frontend/vue3/router/advanced/composition-api",title:"Vue Router and the Composition API",description:"Accessing the Router and current Route inside setup",source:"@site/docs/00200-frontend/vue3/030-router/030-advanced/040-composition-api.md",sourceDirName:"00200-frontend/vue3/030-router/030-advanced",slug:"/frontend/vue3/router/advanced/composition-api",permalink:"/dddtdd-docs/frontend/vue3/router/advanced/composition-api",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1720187019e3,sidebarPosition:40,frontMatter:{},sidebar:"docSidebar",previous:{title:"Data Fetching",permalink:"/dddtdd-docs/frontend/vue3/router/advanced/data-fetching"},next:{title:"RouterView slot",permalink:"/dddtdd-docs/frontend/vue3/router/advanced/router-view-slot"}},i={},c=[{value:"Accessing the Router and current Route inside setup",id:"accessing-the-router-and-current-route-inside-setup",level:2},{value:"Navigation Guards",id:"navigation-guards",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"vue-router-and-the-composition-api",children:"Vue Router and the Composition API"}),"\n",(0,r.jsx)(n.h2,{id:"accessing-the-router-and-current-route-inside-setup",children:"Accessing the Router and current Route inside setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"<script setup>\r\nimport { useRouter, useRoute } from 'vue-router'\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nfunction pushWithQuery(query) {\r\n  router.push({\r\n    name: 'search',\r\n    query: {\r\n      ...route.query,\r\n      ...query,\r\n    },\r\n  })\r\n}\r\n<\/script>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"route"})," object is a reactive object. In most scenarios, you should ",(0,r.jsx)(n.strong,{children:"avoid watching the whole"})," route object. Instead, you can directly watch the properties you are expecting to change"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"<script setup>\r\nimport { useRoute } from 'vue-router'\r\nimport { ref, watch } from 'vue'\r\n\r\nconst route = useRoute()\r\nconst userData = ref()\r\n\r\n// fetch the user information when params change\r\nwatch(\r\n  () => route.params.id,\r\n  async newId => {\r\n    userData.value = await fetchUser(newId)\r\n  }\r\n)\r\n<\/script>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"navigation-guards",children:"Navigation Guards"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"<script setup>\r\nimport { onBeforeRouteLeave, onBeforeRouteUpdate } from 'vue-router'\r\nimport { ref } from 'vue'\r\n\r\n// same as beforeRouteLeave option but with no access to `this`\r\nonBeforeRouteLeave((to, from) => {\r\n  const answer = window.confirm(\r\n    'Do you really want to leave? you have unsaved changes!'\r\n  )\r\n  // cancel the navigation and stay on the same page\r\n  if (!answer) return false\r\n})\r\n\r\nconst userData = ref()\r\n\r\n// same as beforeRouteUpdate option but with no access to `this`\r\nonBeforeRouteUpdate(async (to, from) => {\r\n  // only fetch the user if the id changed as maybe only the query or the hash changed\r\n  if (to.params.id !== from.params.id) {\r\n    userData.value = await fetchUser(to.params.id)\r\n  }\r\n})\r\n<\/script>\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>u});var r=t(96540);const o={},s=r.createContext(o);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function u(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);