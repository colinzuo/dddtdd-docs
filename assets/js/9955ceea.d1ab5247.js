"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[66757],{16565:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>r});var l=s(74848),t=s(28453);const i={},d=void 0,o={id:"frontend/vue3/element-plus/components/feedback/loading",title:"loading",description:"loading.ts",source:"@site/docs/00200-frontend/vue3/element-plus/components/0400-feedback/0300-loading.md",sourceDirName:"00200-frontend/vue3/element-plus/components/0400-feedback",slug:"/frontend/vue3/element-plus/components/feedback/loading",permalink:"/dddtdd-docs/frontend/vue3/element-plus/components/feedback/loading",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1720187019e3,sidebarPosition:300,frontMatter:{},sidebar:"docSidebar",previous:{title:"drawer",permalink:"/dddtdd-docs/frontend/vue3/element-plus/components/feedback/drawer"},next:{title:"message",permalink:"/dddtdd-docs/frontend/vue3/element-plus/components/feedback/message"}},c={},r=[{value:"loading.ts",id:"loadingts",level:2},{value:"elLoadingComponent",id:"elloadingcomponent",level:3},{value:"vm",id:"vm",level:3},{value:"\u65b9\u6cd5",id:"\u65b9\u6cd5",level:3},{value:"service.ts",id:"servicets",level:2},{value:"resolveOptions",id:"resolveoptions",level:3},{value:"addStyle",id:"addstyle",level:3},{value:"addClassList",id:"addclasslist",level:3},{value:"Loading",id:"loading",level:3},{value:"directive.ts",id:"directivets",level:2},{value:"createInstance",id:"createinstance",level:3}];function a(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"loadingts",children:"loading.ts"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"export function createLoadingComponent(options: LoadingOptionsResolved) {"})}),"\n",(0,l.jsx)(n.h3,{id:"elloadingcomponent",children:"elLoadingComponent"}),"\n",(0,l.jsxs)(n.p,{children:["\u901a\u8fc7",(0,l.jsx)(n.code,{children:"h"}),"\u51fd\u6570\u7ec4\u88c5\uff0c\u5305\u62ec",(0,l.jsx)(n.code,{children:"div"}),", ",(0,l.jsx)(n.code,{children:"spinner"}),"(svg), ",(0,l.jsx)(n.code,{children:"spinnerText"})]}),"\n",(0,l.jsx)(n.p,{children:"\u5176\u4e2droot div\u901a\u8fc7class\u8bbe\u7f6e\u4e86"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-css",children:".el-loading-mask {\n    position: absolute;\n    z-index: 2000;\n    background-color: var(--el-mask-color);\n    margin: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    transition: opacity var(--el-transition-duration);\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"vm",children:"vm"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"  const loadingInstance = createApp(elLoadingComponent)\n  const vm = loadingInstance.mount(document.createElement('div'))\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u65b9\u6cd5",children:"\u65b9\u6cd5"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"setText: \u8bbe\u7f6espinnerText"}),"\n",(0,l.jsx)(n.li,{children:"removeElLoadingChild: \u5220\u9664dom node"}),"\n",(0,l.jsxs)(n.li,{children:["close: \u5148\u8bbe\u7f6e",(0,l.jsx)(n.code,{children:"data.visible = false"}),"\uff0c\u7136\u540e\u8fc7\u51e0\u767e\u6beb\u79d2\u540e",(0,l.jsx)(n.code,{children:"destroySelf()"})]}),"\n",(0,l.jsxs)(n.li,{children:["destroySelf(): \u8c03\u7528",(0,l.jsx)(n.code,{children:"destroySelf()"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"servicets",children:"service.ts"}),"\n",(0,l.jsx)(n.h3,{id:"resolveoptions",children:"resolveOptions"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"    target =\n      document.querySelector<HTMLElement>(options.target) ?? document.body\n\n  return {\n    parent: target === document.body || options.body ? document.body : target,\n    \n    fullscreen: target === document.body && (options.fullscreen ?? true),\n    lock: options.lock ?? false,\n    visible: options.visible ?? true,\n    target,    \n"})}),"\n",(0,l.jsx)(n.h3,{id:"addstyle",children:"addStyle"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"zIndex"}),"\n",(0,l.jsx)(n.li,{children:"top"}),"\n",(0,l.jsx)(n.li,{children:"left"}),"\n",(0,l.jsx)(n.li,{children:"height"}),"\n",(0,l.jsx)(n.li,{children:"width"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"addclasslist",children:"addClassList"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"el-loading-parent--relative"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"loading",children:"Loading"}),"\n",(0,l.jsxs)(n.p,{children:["\u901a\u8fc7",(0,l.jsx)(n.code,{children:"addClassList"}),"\u8bbe\u7f6eparent\u7684",(0,l.jsx)(n.code,{children:"position: relative"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"  const resolved = resolveOptions(options)\n\n  const instance = createLoadingComponent({\n    ...resolved,\n    closed: () => {\n      resolved.closed?.()\n      if (resolved.fullscreen) fullscreenInstance = undefined\n    },\n  })\n  \n  addStyle(resolved, resolved.parent, instance)\n  addClassList(resolved, resolved.parent, instance)\n  \n  resolved.parent.setAttribute('loading-number', loadingNumber)\n\n  resolved.parent.appendChild(instance.$el)\n  \n  nextTick(() => (instance.visible.value = resolved.visible))  \n"})}),"\n",(0,l.jsx)(n.h2,{id:"directivets",children:"directive.ts"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"    const instance = el[INSTANCE_KEY]\n    if (binding.oldValue !== binding.value) {\n      if (binding.value && !binding.oldValue) {\n        createInstance(el, binding)\n      } else if (binding.value && binding.oldValue) {\n        if (isObject(binding.value))\n          updateOptions(binding.value, instance!.options)\n      } else {\n        instance?.instance.close()\n      }\n    }\n"})}),"\n",(0,l.jsx)(n.h3,{id:"createinstance",children:"createInstance"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"  const fullscreen =\n    getBindingProp('fullscreen') ?? binding.modifiers.fullscreen\n\n  const options: LoadingOptions = {\n    text: getProp('text'),\n\n    fullscreen,\n    target: getBindingProp('target') ?? (fullscreen ? undefined : el),\n  }\n  el[INSTANCE_KEY] = {\n    options,\n    instance: Loading(options),\n  }\n"})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>o});var l=s(96540);const t={},i=l.createContext(t);function d(e){const n=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),l.createElement(i.Provider,{value:n},e.children)}}}]);