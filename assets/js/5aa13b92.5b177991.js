"use strict";(self.webpackChunkdoc_center=self.webpackChunkdoc_center||[]).push([[7985],{83910:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>o});var s=r(74848),t=r(28453);const i={title:"HTTP API"},a=void 0,l={id:"middleware/prometheus/api",title:"HTTP API",description:"The current stable HTTP API is reachable under /api/v1 on a Prometheus server",source:"@site/docs/00600-middleware/prometheus/0340-api.md",sourceDirName:"00600-middleware/prometheus",slug:"/middleware/prometheus/api",permalink:"/dddtdd-docs/middleware/prometheus/api",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"Colin Zuo",lastUpdatedAt:1720187019e3,sidebarPosition:340,frontMatter:{title:"HTTP API"},sidebar:"docSidebar",previous:{title:"Examples",permalink:"/dddtdd-docs/middleware/prometheus/examples"},next:{title:"Management API",permalink:"/dddtdd-docs/middleware/prometheus/management_api"}},d={},o=[{value:"Format overview",id:"format-overview",level:2},{value:"Expression queries",id:"expression-queries",level:2},{value:"Instant queries",id:"instant-queries",level:3},{value:"Range queries",id:"range-queries",level:3},{value:"Expression query result formats",id:"expression-query-result-formats",level:2},{value:"Range vectors",id:"range-vectors",level:3},{value:"Instant vectors",id:"instant-vectors",level:3},{value:"Scalars",id:"scalars",level:3},{value:"Rules",id:"rules",level:2},{value:"Alerts",id:"alerts",level:2},{value:"Status",id:"status",level:2},{value:"Build Information",id:"build-information",level:3}];function c(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["The current stable HTTP API is reachable under ",(0,s.jsx)(n.code,{children:"/api/v1"})," on a Prometheus server"]}),"\n",(0,s.jsx)(n.h2,{id:"format-overview",children:"Format overview"}),"\n",(0,s.jsxs)(n.p,{children:["The API response format is JSON. Every successful API request returns a ",(0,s.jsx)(n.code,{children:"2xx"})," status code"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success" | "error",\n  "data": <data>,\n\n  // Only set if status is "error". The data field may still hold\n  // additional data.\n  "errorType": "<string>",\n  "error": "<string>",\n\n  // Only if there were warnings while executing the request.\n  // There will still be data in the data field.\n  "warnings": ["<string>"]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"expression-queries",children:"Expression queries"}),"\n",(0,s.jsx)(n.h3,{id:"instant-queries",children:"Instant queries"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GET /api/v1/query\nPOST /api/v1/query\n"})}),"\n",(0,s.jsx)(n.p,{children:"URL query parameters:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"query=<string>"}),": Prometheus expression query string."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"time=<rfc3339 | unix_timestamp>"}),": Evaluation timestamp. Optional."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"timeout=<duration>"}),": Evaluation timeout. Optional. Defaults to and is capped by the value of the -query.timeout flag"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["You can URL-encode these parameters directly in the request body by using the POST method and ",(0,s.jsx)(n.code,{children:"Content-Type: application/x-www-form-urlencoded"})," header"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"data"})," section of the query result has the following format"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "resultType": "matrix" | "vector" | "scalar" | "string",\n  "result": <value>\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"range-queries",children:"Range queries"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GET /api/v1/query_range\nPOST /api/v1/query_range\n"})}),"\n",(0,s.jsx)(n.p,{children:"URL query parameters:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"query=<string>"}),": Prometheus expression query string."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"start=<rfc3339 | unix_timestamp>"}),": Start timestamp, inclusive."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"end=<rfc3339 | unix_timestamp>"}),": End timestamp, inclusive."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"step=<duration | float>"}),": Query resolution step width in duration format or float number of seconds."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"timeout=<duration>"}),": Evaluation timeout. Optional. Defaults to and is capped by the value of the -query.timeout flag."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"expression-query-result-formats",children:"Expression query result formats"}),"\n",(0,s.jsx)(n.h3,{id:"range-vectors",children:"Range vectors"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "metric": { "<label_name>": "<label_value>", ... },\n    "values": [ [ <unix_time>, "<sample_value>" ], ... ],\n    "histograms": [ [ <unix_time>, <histogram> ], ... ]\n  },\n  ...\n]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"instant-vectors",children:"Instant vectors"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "metric": { "<label_name>": "<label_value>", ... },\n    "value": [ <unix_time>, "<sample_value>" ],\n    "histogram": [ <unix_time>, <histogram> ]\n  },\n  ...\n]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"scalars",children:"Scalars"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[ <unix_time>, "<scalar_value>" ]\n'})}),"\n",(0,s.jsx)(n.h2,{id:"rules",children:"Rules"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"/rules"})," API endpoint returns a list of alerting and recording rules that are currently loaded. In addition it returns the currently ",(0,s.jsx)(n.strong,{children:"active alerts"})," fired by the Prometheus instance of each alerting rule"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GET /api/v1/rules\n"})}),"\n",(0,s.jsx)(n.p,{children:"URL query parameters:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"type=alert|record"}),": return only the alerting rules (e.g. type=alert) or the recording rules (e.g. type=record). When the parameter is absent or empty, no filtering is done."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"rule_name[]=<string>"}),": only return rules with the given rule name. If the parameter is repeated, rules with any of the provided names are returned. If we've filtered out all the rules of a group, the group is not returned. When the parameter is absent or empty, no filtering is done."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"rule_group[]=<string>"}),": only return rules with the given rule group name. If the parameter is repeated, rules with any of the provided rule group names are returned. When the parameter is absent or empty, no filtering is done."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"file[]=<string>"}),": only return rules with the given filepath. If the parameter is repeated, rules with any of the provided filepaths are returned. When the parameter is absent or empty, no filtering is done."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"alerts",children:"Alerts"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"/alerts"})," endpoint returns a list of all active alerts"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GET /api/v1/alerts\n"})}),"\n",(0,s.jsx)(n.h2,{id:"status",children:"Status"}),"\n",(0,s.jsx)(n.h3,{id:"build-information",children:"Build Information"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"GET /api/v1/status/buildinfo"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "data": {\n    "version": "2.13.1",\n    "revision": "cb7cbad5f9a2823a622aaa668833ca04f50a0ea7",\n    "branch": "master",\n    "buildUser": "julius@desktop",\n    "buildDate": "20191102-16:19:59",\n    "goVersion": "go1.13.1"\n  }\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>l});var s=r(96540);const t={},i=s.createContext(t);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);